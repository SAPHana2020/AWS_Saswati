aws glue create-database --database-input "Name=dbsaswati"

aws glue create-crawler --name cli-crawlercsv --role arn:aws:iam::653200375372:role/service-role/AWSGlueServiceRole-saswati --database-name dbsaswati --targets "S3Targets=[{Path='s3://mybucketsaswati/covid-19-testing-data/dataset/datasetcsv/state_current/'},{Path='s3://mybucketsaswati/covid-19-testing-data/dataset/datasetcsv/states_daily/'},{Path='s3://mybucketsaswati/covid-19-testing-data/dataset/datasetcsv/states_info/'},{Path='s3://mybucketsaswati/covid-19-testing-data/dataset/datasetcsv/states_screenshots/'},{Path='s3://mybucketsaswati/covid-19-testing-data/dataset/datasetcsv/us_current/'},{Path='s3://mybucketsaswati/covid-19-testing-data/dataset/datasetcsv/us_daily/'}]"

aws glue create-crawler --name cli-crawlerjson --role arn:aws:iam::653200375372:role/service-role/AWSGlueServiceRole-saswati --database-name dbsaswati --targets "S3Targets=[{Path='s3://mybucketsaswati/covid-19-testing-data/dataset/datasetjson/state_current/'},{Path='s3://mybucketsaswati/covid-19-testing-data/dataset/datasetjson/states_daily/'},{Path='s3://mybucketsaswati/covid-19-testing-data/dataset/datasetjson/states_info/'},{Path='s3://mybucketsaswati/covid-19-testing-data/dataset/datasetjson/states_screenshots/'},{Path='s3://mybucketsaswati/covid-19-testing-data/dataset/datasetjson/us_current/'},{Path='s3://mybucketsaswati/covid-19-testing-data/dataset/datasetjson/us_daily/'}]"


aws glue start-crawler --name cli-crawlercsv

aws glue start-crawler --name cli-crawlerjson



docker run -it -v %USERPROFILE%\.aws:/home/glue_user/.aws -v %WORKSPACE_LOCATION%:/home/glue_user/workspace/ -e AWS_PROFILE=%PROFILE_NAME% -e DISABLE_SSL=true --rm -p 4040:4040 -p 18080:18080 --name glue_pyspark amazon/aws-glue-libs:glue_libs_4.0.0_image_01 pyspark

set WORKSPACE_LOCATION=C:\Users\saswamis

PROFILE_NAME="profile_saswati"


aws glue start-job-run --job-name "ConvertCSVToParquetJob"


aws glue create-crawler --name cli-crawlerparquet --role arn:aws:iam::653200375372:role/AWS_Glue_Job_Saswati --database-name dbsaswati --targets "S3Targets=[{Path='s3://mybucketsaswati/CSVtoParquetFile/'}]"

aws glue start-crawler --name cli-crawlerparquet



aws glue create-job --name "MultipleCSVToParquetJob" --role "arn:aws:iam::653200375372:role/AWS_Glue_Job_Saswati" --command '{"Name": "glueetl", "ScriptLocation":"s3://mybucketsaswati/CapstoneScript/csv_to_parquet.py"}'

aws glue start-job-run --job-name MultipleCSVToParquetJob --arguments '{"--input_path": "s3://mybucketsaswati/covid-19-testing-data/dataset/csvdata/", "--output_path": "s3://mybucketsaswati/MultipleCSVToParquetFile/"}'


s3://mybucketsaswati/covid-19-testing-data/dataset/csvdata/

git add csv_to_parquet_job.py

Queries:

SELECT * FROM "AwsDataCatalog"."dbsaswati"."csvtoparquetfile" limit 10;

SELECT * FROM "dbsaswati"."states_info" limit 10;

SELECT * FROM "dbsaswati"."states_screenshots" limit 10;

SELECT state, sum(positive) as positive FROM "dbsaswati"."state_current" group by state order by state;












